# プロジェクト詳細ページ (project/:projectId) 医療システム確認結果書

**文書番号**: MEDICAL-CONFIRM-2025-1019-003
**作成日**: 2025年10月19日
**作成者**: 医療職員管理システムチーム
**対象プロジェクト**: プロジェクト詳細ページ (project/:projectId) DB統合
**VoiceDrive文書**: project/:projectId 暫定マスターリスト
**ステータス**: ✅ 確認完了・承認

---

## 📋 エグゼクティブサマリー

VoiceDriveチームからの **プロジェクト詳細ページ (project/:projectId) 暫定マスターリスト** を確認しました。

**医療システム側の結論**:
- ✅ **医療システム側への影響: ゼロ**
- ✅ **医療システム側の実装: 不要**
- ✅ **医療システム側のコスト: ¥0**
- ✅ **VoiceDrive側の実装計画を全面承認**

---

## 🔍 確認内容サマリー

### プロジェクト概要

| 項目 | 内容 |
|------|------|
| **対象ページ** | ProjectDetailPage (`src/pages/ProjectDetailPage.tsx`) |
| **現状** | 100%デモデータで動作 |
| **実施内容** | DB統合（プロジェクト詳細、承認フロー、メンバー管理） |
| **実施期間** | 2025年12月18日～12月30日（Projects Legacy完了後） |
| **総工数** | 11日（VoiceDrive側） |
| **総コスト** | ¥440,000（VoiceDrive側） |

---

## ✅ 医療システム側への影響確認

### 1. データベーススキーマへの影響

| 項目 | VoiceDrive側の変更 | 医療システム側への影響 |
|------|------------------|---------------------|
| **Postテーブル拡張** | 2フィールド追加（title, consensusLevel） | ❌ 影響なし（VoiceDriveテーブル） |
| **ProjectTeamMemberテーブル拡張** | 1フィールド追加（status） | ❌ 影響なし（VoiceDriveテーブル） |

**結論**: 医療システムのスキーマ変更は **一切不要**

### 2. APIへの影響

| 項目 | VoiceDrive側の実装 | 医療システム側への影響 |
|------|------------------|---------------------|
| **新規APIエンドポイント** | 3つ作成（詳細取得、承認、参加） | ❌ 影響なし（VoiceDrive側で完結） |
| **ProjectService拡張** | 3メソッド追加 | ❌ 影響なし（VoiceDrive側のみ） |
| **既存API利用** | 医療システムの既存API（ユーザー、部署）を参照 | ✅ 既存APIのみ使用（新規実装不要） |

**結論**: 医療システムの新規API実装は **一切不要**

### 3. データ管理責任分界点

#### VoiceDrive側の責任（100%）

| データカテゴリ | 管理テーブル | 詳細 |
|--------------|-------------|------|
| **プロジェクト詳細** | Post | title, content, consensusLevel, status |
| **承認フロー** | ProjectApproval | 承認ステップ、承認者、コメント |
| **チームメンバー** | ProjectTeamMember | メンバーリスト、役割、参加ステータス |
| **タイムライン** | Post | votingDeadline, projectStart, projectEnd |

#### 医療システム側からの参照（既存APIのみ、読み取り専用）

| データカテゴリ | ソース | 用途 |
|--------------|-------|------|
| **ユーザー情報** | `GET /api/employees/{id}` | author.name, member.name 表示 |
| **部署情報** | `GET /api/departments/{id}` | department 表示 |

**重要**: 医療システム側は一切のProjectデータを保持しない
- VoiceDriveが100%管理
- 医療システムからは既存APIのみ使用（新規実装なし）

---

## 📊 実装計画の確認

### Phase 1～6 の概要

| Phase | 期間 | 工数 | VoiceDrive作業内容 | 医療システム作業 |
|-------|------|------|------------------|----------------|
| **Phase 1** | 12/18～12/19 | 2日 | スキーマ拡張（Post, ProjectTeamMember） | ❌ なし |
| **Phase 2** | 12/20～12/23 | 3日 | ProjectService実装（3メソッド） | ❌ なし |
| **Phase 3** | 12/24～12/25 | 2日 | APIエンドポイント実装（3件） | ❌ なし |
| **Phase 4** | 12/26～12/27 | 2日 | ProjectDetailPage統合 | ❌ なし |
| **Phase 5** | 12/28～12/29 | 2日 | E2Eテスト・承認フロー確認 | ❌ なし |
| **Phase 6** | 12/30 | - | 本番リリース | ❌ なし |

**合計**: 11日、¥440,000（全額VoiceDrive側）

### 実装アーキテクチャの確認

VoiceDriveチームが選択した実装方針を確認しました。

**設計決定**:
- Postテーブルにtitle, consensusLevelフィールド追加
- ProjectTeamMemberテーブルにstatusフィールド追加（invited, accepted, declined）
- 3つの新規APIエンドポイント実装

**医療システム側の見解**: ✅ 承認
- Projects Legacyとの整合性が高い（Post中心アーキテクチャ）
- 実装が最小限で済む
- 医療システム側への影響ゼロ

---

## 💰 コスト確認

### VoiceDrive側の開発コスト

| Phase | 作業内容 | 工数 | コスト |
|-------|---------|------|--------|
| **Phase 1** | スキーマ拡張 | 2日 | ¥80,000 |
| **Phase 2** | ProjectService実装 | 3日 | ¥120,000 |
| **Phase 3** | APIエンドポイント実装 | 2日 | ¥80,000 |
| **Phase 4** | ProjectDetailPage統合 | 2日 | ¥80,000 |
| **Phase 5** | E2Eテスト・承認フロー確認 | 2日 | ¥80,000 |
| **合計** | | **11日** | **¥440,000** |

### 医療システム側のコスト

| 項目 | 工数 | コスト |
|------|------|--------|
| **DB変更** | 0日 | ¥0 |
| **API実装** | 0日 | ¥0 |
| **UI変更** | 0日 | ¥0 |
| **テスト** | 0日 | ¥0 |
| **合計** | **0日** | **¥0** |

### 月額運用コスト

| 項目 | 医療システム | VoiceDrive | 備考 |
|------|------------|-----------|------|
| **データベース** | ¥0 | ¥0 | 既存のLightsail統合インスタンス使用 |
| **API** | ¥0 | ¥0 | 追加コストなし |
| **合計** | **¥0** | **¥0** | 追加コストなし |

---

## 📅 スケジュール確認

### 依存関係

**前提条件**:
1. ✅ Phase 1.2 (MySQL移行) 完了
2. ✅ Phase 24 (Projects Legacy DB統合) 完了
3. ⏳ consensusLevel計算方法の確定（VoiceDriveチーム内確認）

**医療システム側の準備**: **不要**
- Phase 24完了を待つのみ
- 医療システム側の作業なし

### 実装スケジュール

```
2025年12月18日（木）Phase 1開始
    ↓
    【VoiceDrive単独作業】（11日間）
    ↓
2025年12月29日（日）Phase 5完了
    ↓
2025年12月30日（月）リリース
```

**医療システム側の参加**: **なし**

---

## ❓ VoiceDriveチーム内の確認事項

### 確認-1: consensusLevel計算方法の確定

VoiceDriveチームが提示した2つのオプションを確認しました。

**Option A: シンプルな計算式**（推奨）
```typescript
consensusLevel = Math.round(
  ((stronglySupportCount + supportCount) / totalEngagements) * 100
)
```

**Option B: 重み付け計算**
```typescript
consensusLevel = Math.round(
  ((stronglySupportCount * 2 + supportCount) /
   (totalEngagements * 2)) * 100
)
```

**医療システム側の見解**:
- ✅ **Option A推奨**
  - シンプルで理解しやすい
  - パフォーマンス優先（Post.consensusLevelに保存）
  - 投票時に自動更新

**保存方針**:
- ✅ **Post.consensusLevelに保存**
  - リアルタイム計算より高速
  - データベースインデックス活用可能
  - 投票イベント時に自動更新

---

## 🎯 成功指標の確認

### 技術指標

| 指標 | 目標値 | 測定方法 | 医療システム関与 |
|------|--------|---------|----------------|
| **API応答時間** | < 500ms | VoiceDrive測定 | ❌ なし |
| **承認フロー精度** | 100% | ステップ遷移テスト | ❌ なし |
| **メンバー参加機能** | 100% | ステータス更新テスト | ❌ なし |
| **合意レベル計算精度** | 100% | 期待値との一致率 | ❌ なし |

### ビジネス指標

| 指標 | 目標値 | 測定方法 | 医療システム関与 |
|------|--------|---------|----------------|
| **プロジェクト詳細表示率** | 100% | DB→UI表示率 | ❌ なし |
| **承認完了率** | > 90% | 承認フロー完了率 | ❌ なし |
| **メンバー参加率** | > 80% | 招待→参加受諾率 | ❌ なし |

**結論**: すべてVoiceDrive側で測定・管理

---

## 🚨 リスク確認

VoiceDriveチームが特定したリスクを確認しました。

### リスク1: consensusLevel計算の複雑性

**VoiceDrive側の対策**:
- Option A採用でシンプル化
- Post.consensusLevelに保存してパフォーマンス確保
- 投票イベント時に自動更新

**医療システム側の見解**: ✅ 適切な対策
- VoiceDrive内部の設計判断として妥当
- 医療システム側への影響なし

### リスク2: 承認フロー複雑性

**VoiceDrive側の対策**:
- ApprovalFlowServiceとの統合
- ProjectApproval正規化
- 権限チェック厳格化

**医療システム側の見解**: ✅ 適切な対策
- VoiceDrive側で完結する問題
- 医療システム側の対応不要

### リスク3: メンバーステータス管理

**VoiceDrive側の対策**:
- statusフィールド追加（invited, accepted, declined）
- 招待されているユーザーのみ参加可能
- 通知システムとの連携

**医療システム側の見解**: ✅ 適切な対策
- 医療システムAPIへの負荷増加なし（既存API利用のみ）
- ステータス管理はVoiceDrive内部で完結

---

## ✅ 医療システム側の承認事項

### 1. データベース設計承認

✅ **承認**: Postテーブル拡張（title, consensusLevel）、ProjectTeamMemberテーブル拡張（status）

**理由**:
- Projects Legacyとの整合性が高い
- 実装が最小限で済む
- 医療システム側への影響ゼロ

### 2. API設計承認

✅ **承認**: VoiceDrive側での新規エンドポイント作成（3件）

**新規エンドポイント**（すべてVoiceDrive側）:
- `GET /api/projects/:projectId`（プロジェクト詳細取得）
- `POST /api/projects/:projectId/approve`（承認）
- `POST /api/projects/:projectId/join`（参加）

**医療システム側のAPI**: 既存APIのみ使用（変更なし）

### 3. 実装スケジュール承認

✅ **承認**: 2025年12月18日～12月30日（Phase 24完了後）

**前提条件**:
- Phase 1.2 (MySQL移行) 完了
- Phase 24 (Projects Legacy DB統合) 完了

**医療システム側の作業**: なし

### 4. コスト承認

✅ **承認**: 医療システム側コスト ¥0

| 項目 | 医療システム | VoiceDrive |
|------|------------|-----------|
| **開発コスト** | ¥0 | ¥440,000 |
| **月額運用コスト** | ¥0 | ¥0 |

### 5. consensusLevel計算方法承認

✅ **承認**: Option A（シンプルな計算式）推奨

**計算式**:
```typescript
consensusLevel = Math.round(
  ((stronglySupportCount + supportCount) / totalEngagements) * 100
)
```

**保存方針**: Post.consensusLevelに保存、投票時に自動更新

---

## 📝 医療システム側の次のアクション

### 即座実行（不要）

**対応不要の理由**:
- ProjectDetailPage は VoiceDrive 100% 管理
- 医療システムからの新規API提供は不要
- 既存APIのみ使用（変更なし）

### Phase 24完了後（2025年12月18日～）

**医療システムチームの作業**: **なし**

**VoiceDriveチームの作業**:
- Phase 1-6 の実装
- E2Eテスト・承認フロー確認
- リリース

### 統合テスト時（2025年12月28日～29日）

**医療システムチームの参加**: **任意**
- VoiceDrive側のテストのみ
- 医療システムAPIの動作確認は不要（既存APIのみ使用のため）

**参加する場合の確認事項**:
- 既存API（ユーザー、部署）が正常に応答しているか
- VoiceDrive側からの呼び出しに問題がないか

---

## 🎉 まとめ

### 確認結果

✅ **医療システム側への影響: ゼロ**
- DBスキーマ変更なし
- API実装なし
- UI変更なし
- テスト作業なし

✅ **医療システム側のコスト: ¥0**
- 開発コスト: ¥0
- 運用コスト: ¥0

✅ **VoiceDrive側の実装計画を全面承認**
- Postテーブル拡張（title, consensusLevel）承認
- ProjectTeamMemberテーブル拡張（status）承認
- 3つの新規APIエンドポイント承認
- 実装スケジュール（12/18～12/30）承認
- コスト（¥440,000）承認
- consensusLevel計算方法（Option A）推奨

### VoiceDriveチームへのメッセージ

**医療職員管理システムチームより**:

プロジェクト詳細ページ (project/:projectId) 暫定マスターリストを確認しました。非常に詳細で包括的な分析をしていただき、ありがとうございます。

**承認事項**:
1. ✅ Postテーブル拡張（title, consensusLevel）を承認します
2. ✅ ProjectTeamMemberテーブル拡張（status）を承認します
3. ✅ 実装スケジュール（2025年12月18日～12月30日）を承認します
4. ✅ 医療システム側の既存APIのみ使用する設計を承認します
5. ✅ 医療システム側の追加作業ゼロを確認しました
6. ✅ consensusLevel計算方法（Option A: シンプルな計算式）を推奨します

**期待する成果**:
- ProjectDetailPageのリアルタイムデータ表示
- 承認フロー、メンバー管理の完全DB統合
- デモデータからの完全脱却

Phase 24完了後、スムーズな実装開始を期待しています。

---

## 📞 連絡先

**医療職員管理システムチーム**
- Slack: `#phase2-integration`
- MCPサーバー: `mcp-shared/docs/`
- 担当者: 医療システムプロジェクトリード

**質問事項**:
- 実装に関する技術的な質問
- スケジュール調整（必要な場合）

---

## 📚 関連ドキュメント

### VoiceDriveチームからの文書

| 文書 | ファイル名 | 受領日 |
|------|-----------|--------|
| **暫定マスターリスト** | `project/:projectId 暫定マスターリスト` | 2025年10月19日 |

### 医療システム側の文書

| 文書 | ファイル名 | 作成日 |
|------|-----------|--------|
| **本確認結果書** | `project-detail_医療システム確認結果_20251019.md` | 2025年10月19日 |

### 参考ドキュメント

- [projects-legacy_医療システム確認結果_20251019.md](./projects-legacy_医療システム確認結果_20251019.md)
- [idea-tracking-project-mode_医療システム確認結果_20251019.md](./idea-tracking-project-mode_医療システム確認結果_20251019.md)

---

**プロジェクト詳細ページ (project/:projectId) の医療システム側確認を完了し、VoiceDriveチームの実装計画を全面承認しました。**

**医療職員管理システムチーム**
2025年10月19日
