# CareerSelectionStation統合実装 - VoiceDriveチームへの連絡書

**文書番号**: MED-NOTICE-CS-2025-1018-001
**作成日**: 2025年10月18日
**送信元**: 医療システムチーム
**送信先**: VoiceDriveチーム
**件名**: Phase 22（キャリア選択ステーション）マスタープラン統合完了のご連絡

---

## 📋 連絡事項サマリー

VoiceDriveチームの皆様

お疲れ様です。医療システムチームです。

キャリア選択ステーション（CareerSelectionStation）の分析・設計作業が完了し、**マスタープランにPhase 22として統合**いたしましたので、ご連絡申し上げます。

---

## ✅ 完了した作業

### 1. ドキュメント作成完了（2件）

以下の2つのドキュメントを作成いたしました：

#### ドキュメント1: 統合マスターリスト最終版
- **ファイル名**: `CareerSelectionStation_統合マスターリスト_FINAL_20251018.md`
- **文書番号**: MASTER-CS-2025-1018-FINAL
- **内容**:
  - エグゼクティブサマリー（SSOT定義、データ保持期間）
  - データベース設計（3テーブル、拡張版フィールド定義）
  - API仕様（4エンドポイント、v2）
  - Webhook仕様（2種類、dot.notation形式）
  - AWS S3ストレージ設計（Intelligent-Tiering）
  - 実装フェーズ（Phase 1-5）
  - コスト見積もり（22-31人日）
  - マスタープラン統合情報

#### ドキュメント2: 医療システム確認結果
- **ファイル名**: `CareerSelectionStation_医療システム確認結果_20251018.md`
- **文書番号**: MS-CONFIRM-CS-2025-1018-001
- **内容**:
  - 確認ステータス: ✅ 実装準備完了
  - データベース設計確認（3テーブル承認）
  - データ保持期間承認: **全期間保存（削除なし）** ✅
  - API実装確認（4エンドポイント、全て実装可能）
  - Webhook実装確認（2種類、全て実装可能）
  - ストレージ設計確認（AWS S3承認）
  - コスト見積確認（17-24人日、承認）
  - リスク評価と軽減策
  - 最終承認と次のステップ

### 2. マスタープラン統合完了

**マスタープラン Version 2.34 → 2.35に更新**

- **Phase 22として追加**: キャリア選択ステーション統合実装
- **更新日**: 2025年10月18日
- **Phase 1.6 テーブル数更新**: **159 → 162テーブル**
  - 医療システム: 146 → 149テーブル（+3テーブル）
  - VoiceDrive: 13テーブル（変更なし）

---

## 🎯 Phase 22の概要

### キャリアコース概要

医療職員が自身のワークライフバランスとキャリア志向に応じて、4つのキャリアコース（A/B/C/D）を選択・変更できるシステムです。

| コース | 名称 | 特徴 |
|--------|------|------|
| **Aコース** | フル協力型 | フルタイム・管理職志向・全施設転勤可能・夜勤あり |
| **Bコース** | 施設内協力型 | フルタイム・現場志向・施設内異動のみ・夜勤選択可 |
| **Cコース** | スペシャリスト型 | 時短勤務・夜勤なし（育児・介護等の特別事由） |
| **Dコース** | 短時間・制約型 | パートタイム・柔軟勤務・夜勤なし |

### データ管理責任分界点（SSOT）

**Single Source of Truth**: **医療職員管理システム**

| データ項目 | データ管理責任 | VoiceDriveの役割 |
|-----------|--------------|------------------|
| コース定義マスタ | 医療システム | 表示専用（API取得） |
| コース選択履歴 | 医療システム | 表示専用（API取得） |
| 変更申請データ | 医療システム | 申請UI提供、API送信 |
| 添付ファイル（証明書等） | 医療システム（AWS S3） | アップロードUI提供 |

### データ保持期間

**🔴 重要決定事項**: **全期間保存（削除なし）**

**理由**:
1. **Phase 19（CultureDevelopment）との統一**
2. **長期的なキャリア開発分析**に全履歴が必要
3. 特別事由（妊娠・介護・疾病）によるコース変更の**長期影響分析**に必須
4. A/B/C/Dコース間の移動パターン分析には**10年以上のデータ**が必要な場合がある
5. 組織の人事戦略、キャリア開発施策の**効果測定**に長期データが不可欠

---

## 📊 実装仕様

### データベース（医療システム側: 3テーブル新規追加）

#### テーブル1: career_course_definitions（コース定義マスタ）
- **フィールド数**: 14フィールド
- **主要フィールド**: course_code（A/B/C/D）、course_name、description、勤務条件各種
- **役割**: A/B/C/Dの4コースの定義と条件を管理

#### テーブル2: career_course_selections（コース選択履歴）
- **フィールド数**: 18フィールド
- **主要フィールド**: employee_id、course_code、effective_date、is_current（パフォーマンス最適化）
- **役割**: 職員のコース選択履歴を全期間保存

#### テーブル3: career_course_change_requests（コース変更申請）
- **フィールド数**: 16フィールド
- **主要フィールド**: employee_id、current_course、requested_course、special_change_reason、attachments（JSON）
- **役割**: コース変更申請の管理（承認・却下・取り下げ）

### API仕様（医療システム側: 4エンドポイント）

| API | メソッド | エンドポイント | 説明 |
|-----|---------|---------------|------|
| **API-1** | GET | `/api/v2/employees/{employeeId}/career-course` | 職員のコース情報取得 |
| **API-2** | GET | `/api/v2/career-course/definitions` | コース定義マスタ取得 |
| **API-3** | POST | `/api/v2/career-course/change-request` | コース変更申請 |
| **API-4** | GET | `/api/v2/career-course/my-requests` | 自分の申請一覧取得 |

### Webhook仕様（医療システム → VoiceDrive: 2種類）

| Webhook | イベント名 | 説明 |
|---------|-----------|------|
| **Webhook-1** | `career_course.change_approved` | コース変更承認時 |
| **Webhook-2** | `career_course.change_rejected` | コース変更却下時 |

**認証方式**: HMAC-SHA256署名（Phase 3～21と統一）

### AWS S3ストレージ設計

- **バケット名**: `medical-system-career-course-attachments`
- **ディレクトリ構造**:
  - `pregnancy/{employeeId}/{requestId}/` - 妊娠証明書
  - `caregiving/{employeeId}/{requestId}/` - 介護証明書
  - `illness/{employeeId}/{requestId}/` - 疾病証明書
- **暗号化**: SSE-S3（AES-256）
- **ストレージクラス**: S3 Intelligent-Tiering（自動階層化）
- **アクセス制御**: 本人＋人事部門（Level 15+）のみ
- **署名付きURL有効期限**: 24時間

---

## 💰 コスト見積

### 開発コスト

| チーム | 工数 | 金額 |
|--------|------|------|
| **医療システム** | 17-24人日 | ¥680,000～¥960,000 |
| **VoiceDrive** | 5-7人日 | ¥200,000～¥280,000 |
| **合計** | 22-31人日 | ¥880,000～¥1,240,000 |

### 運用コスト（AWS S3）

| 期間 | 月額コスト | 備考 |
|------|-----------|------|
| 初年度 | ¥50-100/月 | データ量小、Frequent Tierメイン |
| 5年後 | ¥300/月 | データ量増加、Intelligent-Tiering自動最適化 |

---

## 📅 実装スケジュール

### 実装フェーズ（Phase 1-5）

| フェーズ | 期間 | 作業内容 | 工数 |
|---------|------|---------|------|
| **Phase 1** | 3-4人日 | DB構築（3テーブル作成、マイグレーション） | 医療3-4人日 |
| **Phase 2** | 7-9人日 | API実装（4エンドポイント、バリデーション） | 医療7-9人日 |
| **Phase 3** | 2-4人日 | Webhook実装（2種類、HMAC-SHA256署名） | 医療2-4人日 |
| **Phase 4** | 5-7人日 | VoiceDrive UI実装（PersonalStation拡張、申請フォーム） | VoiceDrive5-7人日 |
| **Phase 5** | 3-4人日 | 統合テスト（4シナリオ、E2E） | 両チーム3-4人日 |

**総実装期間**: 約4-6週間

**依存関係**:
- ✅ Phase 1.6（統合DB構築）完了後に実装可能
- ⚠️ AWS S3バケット準備必須（医療システム側で事前準備）
- ⚠️ JWT認証基盤準備必須（既存Phase 3～21で構築済み）

---

## 🔍 VoiceDriveチームへの確認事項

以下の3点について、ご確認をお願いいたします：

### 確認-1: PersonalStationページへのコースセクション追加位置

PersonalStationページに「キャリアコースセクション」を追加する予定ですが、どこに配置するのが最適でしょうか？

**選択肢**:
- **A**: 「基本情報」セクションの下（推奨）
- **B**: 「経験年数サマリ」セクションの下
- **C**: 新規タブとして独立（「キャリアコース」タブ）
- **D**: その他（ご提案があればお聞かせください）

**推奨理由（選択肢A）**:
- キャリアコースは職員の基本属性の一部
- PersonalStationは基本情報の確認がメイン用途
- 新規タブは不要（コース情報は比較的シンプル）

### 確認-2: コース変更申請フォームのUI設計

コース変更申請フォームは、どの形式が望ましいでしょうか？

**選択肢**:
- **A**: モーダルダイアログ形式（推奨）
- **B**: PersonalStation内の展開フォーム
- **C**: 独立した新規ページ（/career-course/change-request）
- **D**: その他（ご提案があればお聞かせください）

**推奨理由（選択肢A）**:
- 申請は年1回程度の低頻度操作
- モーダルで集中して入力可能
- PersonalStationの既存レイアウトを崩さない
- 添付ファイルアップロード機能も組み込みやすい

### 確認-3: Webhook受信後のUI更新タイミング

コース変更が承認/却下された際のWebhook受信後、VoiceDrive側でどのようにUIを更新しますか？

**選択肢**:
- **A**: Webhook受信時にデータベース更新 + 次回ページアクセス時に反映（推奨）
- **B**: Webhook受信時にデータベース更新 + Server-Sent Events (SSE)でリアルタイム通知
- **C**: Webhook受信時にデータベース更新 + メール通知のみ（UI更新はページリロード時）
- **D**: その他（ご提案があればお聞かせください）

**推奨理由（選択肢A）**:
- コース変更承認/却下は緊急性が低い
- SSE実装コストがかかる（Phase 20面談予約では採用したが、本Phaseでは不要）
- メール通知＋次回アクセス時反映で十分
- 実装コスト削減（VoiceDrive側0.5-1人日削減）

---

## 📝 次のアクション

### VoiceDriveチーム側

1. **本連絡書の確認**: 2025年10月21日（月）まで
2. **確認事項への回答**: 2025年10月25日（金）まで
   - 確認-1: PersonalStation配置位置
   - 確認-2: 申請フォームUI形式
   - 確認-3: Webhook後のUI更新タイミング
3. **回答書の作成**: 上記3点への回答を文書化してご送付ください
   - 文書番号: `VD-RESPONSE-CS-2025-10XX-001`形式
   - ファイル名: `CareerSelectionStation_VoiceDrive回答書_20251025.md`

### 医療システムチーム側

1. **VoiceDriveチームの回答待機**: 2025年10月25日まで
2. **回答受領後、最終仕様確定**: 2025年10月28日
3. **Phase 1.6（統合DB構築）待機**: 共通DB構築完了後に実装開始

### 両チーム共同

1. **実装開始**: Phase 1.6完了後（時期未定、ライトセイル構築次第）
2. **Phase 1-5実装**: 約4-6週間
3. **統合テスト**: 4シナリオ（通常変更、特別事由、却下、取り下げ）
4. **本番リリース**: Phase 1.6完了 + 4-6週間後

---

## 📎 関連ドキュメント

### 作成済みドキュメント（2件）

1. **統合マスターリスト最終版**
   - パス: `mcp-shared/docs/CareerSelectionStation_統合マスターリスト_FINAL_20251018.md`
   - 文書番号: MASTER-CS-2025-1018-FINAL

2. **医療システム確認結果**
   - パス: `mcp-shared/docs/CareerSelectionStation_医療システム確認結果_20251018.md`
   - 文書番号: MS-CONFIRM-CS-2025-1018-001

### マスタープラン

- **ファイル**: `mcp-shared/docs/lightsail-integration-master-plan-20251005-updated.md`
- **最新バージョン**: 2.35（2025年10月18日更新）
- **Phase 22セクション**: 更新履歴テーブルの最終行に追加済み

### VoiceDriveチームから受領済みドキュメント

1. **DB要件分析**
   - 文書番号: CS-DB-REQ-2025-1013-001
   - 受領日: 2025年10月13日

2. **暫定マスターリスト**
   - 文書番号: CS-MASTER-2025-1013-001
   - 受領日: 2025年10月13日

---

## 🎯 重要ポイントのまとめ

### データ保持期間の重要決定

**全期間保存（削除なし）** ✅

この決定は、以下の理由により行われました：
- Phase 19（CultureDevelopment）との統一
- 長期的なキャリア開発分析に必須
- 特別事由（妊娠・介護・疾病）の長期影響分析に必須
- 10年以上の移動パターン分析が必要な場合がある

### SSOT（Single Source of Truth）

**医療職員管理システム**がマスタです。

VoiceDriveは表示専用であり、全データはAPIを通じてリアルタイムに取得します。
データの整合性を保つため、VoiceDrive側では一切のキャリアコースデータを保存しません。

### Phase 1.6テーブル数更新

**159 → 162テーブル**

医療システム側に3テーブル追加され、累計162テーブルとなります。

---

## 💬 連絡先

ご不明点、ご質問等ございましたら、以下までお気軽にお問い合わせください：

- **医療システムチーム**: medical-team@example.com
- **担当者**: 医療システム開発担当
- **Slackチャンネル**: #lightsail-integration

---

**以上、よろしくお願いいたします。**

医療システムチーム
2025年10月18日
