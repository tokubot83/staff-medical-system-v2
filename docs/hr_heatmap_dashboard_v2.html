<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äººäº‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒæˆ¦ç•¥ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans JP', -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 2.2em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        
        .phase-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }
        
        .phase-btn {
            padding: 15px 30px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 200px;
        }
        
        .phase-btn:hover {
            background: #f8f9fa;
            transform: translateY(-2px);
        }
        
        .phase-btn.active {
            background: #667eea;
            color: white;
            box-shadow: 0 5px 20px rgba(102,126,234,0.4);
        }
        
        .phase-info {
            background: linear-gradient(135deg, #667eea10, #764ba210);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #e1e8ff;
        }
        
        .phase-title {
            color: #667eea;
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .phase-description {
            color: #5a6c7d;
            line-height: 1.6;
        }
        
        .heatmap-container {
            margin: 30px 0;
        }
        
        .heatmap-grid {
            display: grid;
            grid-template-columns: 150px repeat(4, 1fr);
            gap: 2px;
            background: #e0e0e0;
            padding: 2px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .heatmap-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            font-weight: bold;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .heatmap-row-header {
            background: #f8f9fa;
            padding: 15px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            text-align: center;
        }
        
        .performance-label {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        
        .heatmap-cell {
            background: white;
            padding: 15px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 150px;
        }
        
        .heatmap-cell:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 10;
        }
        
        .cell-intensity-1 { background: #e8f5e9; }
        .cell-intensity-2 { background: #c8e6c9; }
        .cell-intensity-3 { background: #a5d6a7; }
        .cell-intensity-4 { background: #81c784; }
        .cell-intensity-5 { background: #66bb6a; }
        
        .cell-warning-1 { background: #fff3e0; }
        .cell-warning-2 { background: #ffe0b2; }
        .cell-warning-3 { background: #ffcc80; }
        
        .cell-alert-1 { background: #ffebee; }
        .cell-alert-2 { background: #ffcdd2; }
        .cell-alert-3 { background: #ef9a9a; }
        
        .cell-content {
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .cell-percentage {
            font-size: 1.8em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .cell-count {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 10px;
        }
        
        .cell-status {
            font-size: 0.85em;
            padding: 4px 8px;
            border-radius: 5px;
            display: inline-block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .status-ideal { background: #4caf50; color: white; }
        .status-acceptable { background: #2196f3; color: white; }
        .status-caution { background: #ff9800; color: white; }
        .status-alert { background: #f44336; color: white; }
        
        .cell-action {
            font-size: 0.8em;
            color: #555;
            margin-top: auto;
            padding-top: 8px;
            border-top: 1px solid #e0e0e0;
        }
        
        .action-priority {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.75em;
            margin-right: 5px;
            font-weight: bold;
        }
        
        .priority-high { background: #ff5252; color: white; }
        .priority-medium { background: #ffc107; color: white; }
        .priority-low { background: #03a9f4; color: white; }
        
        .legend-container {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .legend-section {
            text-align: center;
        }
        
        .legend-title {
            font-weight: bold;
            color: #666;
            margin-bottom: 10px;
        }
        
        .legend-items {
            display: flex;
            gap: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        
        .action-summary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-top: 40px;
        }
        
        .action-summary h3 {
            font-size: 1.5em;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .action-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .action-card {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .action-card h4 {
            font-size: 1.1em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .action-card ul {
            list-style: none;
            padding: 0;
        }
        
        .action-card li {
            padding: 5px 0;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        .action-card li::before {
            content: "â–¸ ";
            color: #ffd700;
            font-weight: bold;
        }
        
        .detail-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .detail-modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }
        
        .modal-title {
            font-size: 1.4em;
            color: #2c3e50;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5em;
            color: #999;
            cursor: pointer;
        }
        
        .modal-close:hover {
            color: #333;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .metric-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .metric-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }
        
        .metric-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
        }
        
        /* è©•ä¾¡åˆ†å¸ƒãƒãƒ¼ */
        .evaluation-distribution {
            margin: 10px 0;
            height: 25px;
        }
        
        .eval-bar {
            display: flex;
            width: 100%;
            height: 100%;
            border-radius: 4px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .eval-segment {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .eval-segment:hover {
            filter: brightness(1.2);
            transform: scale(1.05);
            z-index: 10;
        }
        
        /* åŸ‹ã‚‚ã‚ŒãŸäººæã‚«ãƒ¼ãƒ‰ */
        .hidden-talents-container {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            padding: 20px;
            border-radius: 15px;
            margin: 30px 0;
            border: 2px solid #ff9800;
        }
        
        .hidden-talents-title {
            color: #e65100;
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .hidden-talents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .hidden-talent-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #ff9800;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .hidden-talent-type {
            font-weight: bold;
            color: #e65100;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .hidden-talent-name {
            font-size: 1.1em;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .hidden-talent-count {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 8px;
        }
        
        .hidden-talent-action {
            background: #fff3e0;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.85em;
            color: #e65100;
            font-weight: bold;
        }
        
        /* è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ èª¬æ˜ */
        .evaluation-system-info {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            padding: 20px;
            border-radius: 15px;
            margin: 30px 0;
            border: 2px solid #4caf50;
        }
        
        .evaluation-system-title {
            color: #2e7d32;
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .evaluation-grades-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .evaluation-grade-box {
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
        }
        
        .two-axis-matrix {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .matrix-grid-5x5 {
            display: grid;
            grid-template-columns: 60px repeat(5, 1fr);
            gap: 2px;
            margin-top: 10px;
        }
        
        .matrix-cell-header {
            background: #667eea;
            color: white;
            padding: 8px;
            text-align: center;
            font-size: 0.85em;
            font-weight: bold;
        }
        
        .matrix-cell {
            background: #f8f9fa;
            padding: 8px;
            text-align: center;
            font-size: 0.8em;
            border: 1px solid #e0e0e0;
        }
        
        .matrix-result-s-plus { background: #ffcdd2; }
        .matrix-result-s { background: #ffe0b2; }
        .matrix-result-a-plus { background: #fff9c4; }
        .matrix-result-a { background: #dcedc8; }
        .matrix-result-b { background: #bbdefb; }
        .matrix-result-c { background: #e0e0e0; }
        .matrix-result-d { background: #ffab91; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ äººäº‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒæˆ¦ç•¥ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—</h1>
            <p class="subtitle">ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥ Ã— ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å±¤åˆ¥ã®æœ€é©æ–½ç­–å¯è¦–åŒ–ã‚·ã‚¹ãƒ†ãƒ </p>
        </div>
        
        <!-- ãƒ•ã‚§ãƒ¼ã‚ºé¸æŠãƒœã‚¿ãƒ³ -->
        <div class="phase-selector">
            <button class="phase-btn active" onclick="selectPhase(1)">
                ç¬¬1æ®µéš<br><span style="font-size:0.8em">ã‚³ãƒ¼ã‚¹åˆ¶åº¦ã®ã¿</span>
            </button>
            <button class="phase-btn" onclick="selectPhase(2)">
                ç¬¬2æ®µéš<br><span style="font-size:0.8em">ï¼‹ç­‰ç´šåˆ¶åº¦</span>
            </button>
            <button class="phase-btn" onclick="selectPhase(3)">
                ç¬¬3æ®µéš<br><span style="font-size:0.8em">ï¼‹è©•ä¾¡åˆ¶åº¦ï¼ˆå®Œæˆï¼‰</span>
            </button>
        </div>
        
        <!-- ãƒ•ã‚§ãƒ¼ã‚ºæƒ…å ± -->
        <div class="phase-info" id="phaseInfo">
            <div class="phase-title">ç¬¬1æ®µéšï¼ˆ2026å¹´4æœˆã€œï¼‰ï¼šã‚­ãƒ£ãƒªã‚¢ã‚³ãƒ¼ã‚¹åˆ¶åº¦å°å…¥</div>
            <div class="phase-description">
                è‡ªå·±é¸æŠã«ã‚ˆã‚‹åƒãæ–¹ã®å¤šæ§˜åŒ–é–‹å§‹ã€‚è©•ä¾¡ãƒ»ç­‰ç´šæœªå°å…¥ã®ãŸã‚ã€é¸æŠã¨å®Ÿæ…‹ã®ã‚®ãƒ£ãƒƒãƒ—ãŒå¤§ãã„æ™‚æœŸã€‚
                ä¸Šä½å±¤ã®Aã‚³ãƒ¼ã‚¹é¸æŠ70%ã€ä¸­é–“å±¤ã§ã‚‚30%ãŒAã‚³ãƒ¼ã‚¹ã‚’é¸æŠã™ã‚‹ã€ŒæœŸå¾…éå¤šã€çŠ¶æ…‹ã€‚
            </div>
        </div>
        
        <!-- ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ— -->
        <div class="heatmap-container">
            <div class="heatmap-grid" id="heatmapGrid">
                <!-- ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ -->
                <div class="heatmap-header">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å±¤</div>
                <div class="heatmap-header">Aã‚³ãƒ¼ã‚¹<br>ãƒ•ãƒ«ã‚¹ãƒšãƒƒã‚¯</div>
                <div class="heatmap-header">Bã‚³ãƒ¼ã‚¹<br>æ–½è¨­å†…é™å®š</div>
                <div class="heatmap-header">Cã‚³ãƒ¼ã‚¹<br>éƒ¨ç½²å›ºå®š</div>
                <div class="heatmap-header">Dã‚³ãƒ¼ã‚¹<br>é™å®šå‹¤å‹™</div>
                
                <!-- ãƒ‡ãƒ¼ã‚¿è¡Œã¯JavaScriptã§å‹•çš„ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- å‡¡ä¾‹ -->
        <div class="legend-container">
            <div class="legend-section">
                <div class="legend-title">é©åˆåº¦</div>
                <div class="legend-items">
                    <div class="legend-item">
                        <div class="legend-color cell-intensity-5"></div>
                        <span>æœ€é©</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color cell-warning-2"></div>
                        <span>è¦èª¿æ•´</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color cell-alert-2"></div>
                        <span>ãƒŸã‚¹ãƒãƒƒãƒ</span>
                    </div>
                </div>
            </div>
            
            <div class="legend-section">
                <div class="legend-title">å„ªå…ˆåº¦</div>
                <div class="legend-items">
                    <div class="legend-item">
                        <span class="action-priority priority-high">é«˜</span>
                        <span>å³æ™‚å¯¾å¿œ</span>
                    </div>
                    <div class="legend-item">
                        <span class="action-priority priority-medium">ä¸­</span>
                        <span>è¨ˆç”»çš„å¯¾å¿œ</span>
                    </div>
                    <div class="legend-item">
                        <span class="action-priority priority-low">ä½</span>
                        <span>çµŒéè¦³å¯Ÿ</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚µãƒãƒªãƒ¼ -->
        <div class="action-summary" id="actionSummary">
            <h3>ğŸ“‹ ç¬¬1æ®µéšã®é‡ç‚¹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h3>
            <div class="action-cards">
                <div class="action-card">
                    <h4>ğŸ¯ ä¸Šä½20%å±¤</h4>
                    <ul>
                        <li>Aã‚³ãƒ¼ã‚¹é¸æŠè€…ã®æ—©æœŸè‚²æˆãƒ—ãƒ­ã‚°ãƒ©ãƒ é–‹å§‹</li>
                        <li>æ³•äººæ¨ªæ–­ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®å‚ç”»æ©Ÿä¼šæä¾›</li>
                        <li>æ¬¡ä¸–ä»£ãƒªãƒ¼ãƒ€ãƒ¼å€™è£œã¨ã—ã¦ã®æ„è­˜ä»˜ã‘</li>
                    </ul>
                </div>
                <div class="action-card">
                    <h4>ğŸ“Š ä¸­é–“60%å±¤</h4>
                    <ul>
                        <li>Aã‚³ãƒ¼ã‚¹é¸æŠè€…ã¸ã®ç¾å®Ÿçš„ãªæœŸå¾…å€¤èª¿æ•´</li>
                        <li>Bãƒ»Cã‚³ãƒ¼ã‚¹ã®é­…åŠ›ã¨å¯èƒ½æ€§ã®èª¬æ˜å¼·åŒ–</li>
                        <li>å€‹åˆ¥ã‚­ãƒ£ãƒªã‚¢ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ã®å®Ÿæ–½</li>
                    </ul>
                </div>
                <div class="action-card">
                    <h4>âš ï¸ è¦æ”¯æ´20%å±¤</h4>
                    <ul>
                        <li>Aã‚³ãƒ¼ã‚¹é¸æŠè€…ã¸ã®æ—©æœŸã‚³ãƒ¼ã‚¹å¤‰æ›´å‹§å¥¨</li>
                        <li>Cãƒ»Dã‚³ãƒ¼ã‚¹ã§ã®å®‰å®šå°±åŠ´æ”¯æ´</li>
                        <li>åŸºç¤ã‚¹ã‚­ãƒ«å‘ä¸Šç ”ä¿®ã®å„ªå…ˆå®Ÿæ–½</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="detail-modal" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">è©³ç´°æƒ…å ±</h3>
                <button class="modal-close" onclick="closeModal()">Ã—</button>
            </div>
            <div id="modalBody">
                <!-- å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            </div>
        </div>
    </div>
    
    <script>
        let currentPhase = 1;
        
        // è©•ä¾¡åˆ¶åº¦ã®å®šç¾©
        const evaluationSystem = {
            grades: {
                'S+': { label: 'æœ€å„ªç§€', color: '#d32f2f', percentage: 5 },
                'S': { label: 'å„ªç§€', color: '#f57c00', percentage: 7 },
                'A+': { label: 'è‰¯å¥½ä¸Šä½', color: '#fbc02d', percentage: 8 },
                'A': { label: 'è‰¯å¥½', color: '#689f38', percentage: 15 },
                'B': { label: 'æ¨™æº–', color: '#1976d2', percentage: 45 },
                'C': { label: 'è¦æ”¹å–„', color: '#757575', percentage: 15 },
                'D': { label: 'è¦æŒ‡å°', color: '#b71c1c', percentage: 5 }
            },
            distribution: {
                top: ['S+', 'S', 'A+'],  // ä¸Šä½20%
                middle: ['A', 'B'],       // ä¸­é–“60%
                low: ['C', 'D']          // è¦æ”¯æ´20%
            }
        };
        
        // ãƒ•ã‚§ãƒ¼ã‚ºã”ã¨ã®ãƒ‡ãƒ¼ã‚¿å®šç¾©
        const phaseData = {
            1: {
                title: "ç¬¬1æ®µéšï¼ˆ2026å¹´4æœˆã€œï¼‰ï¼šã‚­ãƒ£ãƒªã‚¢ã‚³ãƒ¼ã‚¹åˆ¶åº¦å°å…¥",
                description: "è‡ªå·±é¸æŠã«ã‚ˆã‚‹åƒãæ–¹ã®å¤šæ§˜åŒ–é–‹å§‹ã€‚è©•ä¾¡ãƒ»ç­‰ç´šæœªå°å…¥ã®ãŸã‚ã€é¸æŠã¨å®Ÿæ…‹ã®ã‚®ãƒ£ãƒƒãƒ—ãŒå¤§ãã„æ™‚æœŸã€‚ä¸Šä½å±¤ã®Aã‚³ãƒ¼ã‚¹é¸æŠ70%ã€ä¸­é–“å±¤ã§ã‚‚30%ãŒAã‚³ãƒ¼ã‚¹ã‚’é¸æŠã™ã‚‹ã€ŒæœŸå¾…éå¤šã€çŠ¶æ…‹ã€‚ã€è·å“¡æ•°ï¼š500åã€‘",
                data: {
                    top: {
                        A: { percent: "70%", count: "70å", status: "ideal", intensity: "cell-intensity-5", priority: "low", action: "æ—©æœŸè‚²æˆé–‹å§‹", gradeRange: "æƒ³å®š25-45ç´š" },
                        B: { percent: "25%", count: "25å", status: "acceptable", intensity: "cell-intensity-3", priority: "low", action: "æ–½è¨­ãƒªãƒ¼ãƒ€ãƒ¼è‚²æˆ", gradeRange: "æƒ³å®š20-35ç´š" },
                        C: { percent: "5%", count: "5å", status: "acceptable", intensity: "cell-intensity-2", priority: "low", action: "å°‚é–€æ€§å¼·åŒ–", gradeRange: "æƒ³å®š15-28ç´š" },
                        D: { percent: "0%", count: "0å", status: "ideal", intensity: "cell-intensity-1", priority: "low", action: "è©²å½“ãªã—", gradeRange: "-" }
                    },
                    middle: {
                        A: { percent: "30%", count: "90å", status: "caution", intensity: "cell-warning-2", priority: "high", action: "æœŸå¾…å€¤èª¿æ•´å¿…è¦", gradeRange: "æƒ³å®š15-35ç´š" },
                        B: { percent: "40%", count: "120å", status: "ideal", intensity: "cell-intensity-5", priority: "low", action: "ç¶™ç¶šæ”¯æ´", gradeRange: "æƒ³å®š10-25ç´š" },
                        C: { percent: "20%", count: "60å", status: "acceptable", intensity: "cell-intensity-3", priority: "medium", action: "å°‚é–€ç ”ä¿®", gradeRange: "æƒ³å®š8-20ç´š" },
                        D: { percent: "10%", count: "30å", status: "acceptable", intensity: "cell-intensity-2", priority: "low", action: "WLBæ”¯æ´", gradeRange: "æƒ³å®š5-15ç´š" }
                    },
                    low: {
                        A: { percent: "10%", count: "10å", status: "alert", intensity: "cell-alert-3", priority: "high", action: "æ—©æœŸè»¢æ›å‹§å¥¨", gradeRange: "æƒ³å®š10-20ç´š" },
                        B: { percent: "30%", count: "30å", status: "caution", intensity: "cell-warning-1", priority: "medium", action: "åŸºç¤åŠ›å¼·åŒ–", gradeRange: "æƒ³å®š5-15ç´š" },
                        C: { percent: "35%", count: "35å", status: "ideal", intensity: "cell-intensity-4", priority: "low", action: "é©æ­£é…ç½®", gradeRange: "æƒ³å®š3-12ç´š" },
                        D: { percent: "25%", count: "25å", status: "ideal", intensity: "cell-intensity-5", priority: "low", action: "ç¶™ç¶šå°±åŠ´æ”¯æ´", gradeRange: "æƒ³å®š1-10ç´š" }
                    }
                }
            },
            2: {
                title: "ç¬¬2æ®µéšï¼ˆ2026å¹´10æœˆã€œï¼‰ï¼šç­‰ç´šåˆ¶åº¦å°å…¥",
                description: "å…±é€š50ç­‰ç´šåˆ¶åº¦ã«ã‚ˆã‚Šå„ã‚³ãƒ¼ã‚¹ã®ä¸Šé™ãŒæ˜ç¢ºåŒ–ï¼ˆA:50ç´šã€B:40ç´šã€C:30ç´šã€D:20ç´šï¼‰ã€‚èƒ½åŠ›ã¨é¸æŠã®é©æ­£åŒ–ãŒé€²ã‚€èª¿æ•´æœŸã€‚å‡¦é‡å·®ã«ã‚ˆã‚Šç¾å®Ÿçš„ãªé¸æŠã¸ã‚·ãƒ•ãƒˆã€‚ã€è·å“¡æ•°ï¼š500åã€‘",
                courseStructure: {
                    A: { ceiling: 50, coefficient: 1.2, label: "å…¨ç¯„å›²ï¼ˆ1-50ç´šï¼‰" },
                    B: { ceiling: 40, coefficient: 1.1, label: "ä¸Šé™40ç´š" },
                    C: { ceiling: 30, coefficient: 1.0, label: "ä¸Šé™30ç´š" },
                    D: { ceiling: 20, coefficient: 0.9, label: "ä¸Šé™20ç´š" }
                },
                data: {
                    top: {
                        A: { 
                            percent: "60%", 
                            count: "60å", 
                            status: "ideal", 
                            intensity: "cell-intensity-5", 
                            priority: "low", 
                            action: "å¹¹éƒ¨å€™è£œè‚²æˆ",
                            gradeRange: "25-45ç´š",
                            gradeCeiling: "50ç´šã¾ã§å¯"
                        },
                        B: { 
                            percent: "35%", 
                            count: "35å", 
                            status: "ideal", 
                            intensity: "cell-intensity-4", 
                            priority: "low", 
                            action: "æ–½è¨­é‹å–¶å‚ç”»",
                            gradeRange: "20-35ç´š",
                            gradeCeiling: "ä¸Šé™40ç´š"
                        },
                        C: { 
                            percent: "5%", 
                            count: "5å", 
                            status: "acceptable", 
                            intensity: "cell-intensity-3", 
                            priority: "medium", 
                            action: "å°‚é–€è·èªå®š",
                            gradeRange: "15-28ç´š",
                            gradeCeiling: "ä¸Šé™30ç´š"
                        },
                        D: { 
                            percent: "0%", 
                            count: "0å", 
                            status: "ideal", 
                            intensity: "cell-intensity-1", 
                            priority: "low", 
                            action: "è©²å½“ãªã—",
                            gradeRange: "-",
                            gradeCeiling: "-"
                        }
                    },
                    middle: {
                        A: { 
                            percent: "15%", 
                            count: "45å", 
                            status: "acceptable", 
                            intensity: "cell-intensity-3", 
                            priority: "medium", 
                            action: "æ˜‡æ ¼æ”¯æ´",
                            gradeRange: "15-35ç´š",
                            gradeCeiling: "50ç´šã¾ã§å¯"
                        },
                        B: { 
                            percent: "50%", 
                            count: "150å", 
                            status: "ideal", 
                            intensity: "cell-intensity-5", 
                            priority: "low", 
                            action: "ä¸­æ ¸äººæè‚²æˆ",
                            gradeRange: "10-25ç´š",
                            gradeCeiling: "ä¸Šé™40ç´š"
                        },
                        C: { 
                            percent: "25%", 
                            count: "75å", 
                            status: "ideal", 
                            intensity: "cell-intensity-4", 
                            priority: "low", 
                            action: "æŠ€è¡“å‘ä¸Š",
                            gradeRange: "8-20ç´š",
                            gradeCeiling: "ä¸Šé™30ç´š"
                        },
                        D: { 
                            percent: "10%", 
                            count: "30å", 
                            status: "acceptable", 
                            intensity: "cell-intensity-2", 
                            priority: "low", 
                            action: "å¾©å¸°æ”¯æ´",
                            gradeRange: "5-15ç´š",
                            gradeCeiling: "ä¸Šé™20ç´š"
                        }
                    },
                    low: {
                        A: { 
                            percent: "2%", 
                            count: "2å", 
                            status: "alert", 
                            intensity: "cell-alert-2", 
                            priority: "high", 
                            action: "å³æ™‚è»¢æ›",
                            gradeRange: "10-20ç´š",
                            gradeCeiling: "è¦ã‚³ãƒ¼ã‚¹å¤‰æ›´"
                        },
                        B: { 
                            percent: "38%", 
                            count: "38å", 
                            status: "acceptable", 
                            intensity: "cell-intensity-3", 
                            priority: "medium", 
                            action: "æ®µéšçš„è‚²æˆ",
                            gradeRange: "5-15ç´š",
                            gradeCeiling: "ä¸Šé™40ç´š"
                        },
                        C: { 
                            percent: "40%", 
                            count: "40å", 
                            status: "ideal", 
                            intensity: "cell-intensity-5", 
                            priority: "low", 
                            action: "å®šå‹æ¥­å‹™æœ€é©åŒ–",
                            gradeRange: "3-12ç´š",
                            gradeCeiling: "ä¸Šé™30ç´š"
                        },
                        D: { 
                            percent: "20%", 
                            count: "20å", 
                            status: "ideal", 
                            intensity: "cell-intensity-4", 
                            priority: "low", 
                            action: "å¥åº·ç®¡ç†",
                            gradeRange: "1-10ç´š",
                            gradeCeiling: "ä¸Šé™20ç´š"
                        }
                    }
                }
            },
            3: {
                title: "ç¬¬3æ®µéšï¼ˆ2027å¹´4æœˆã€œï¼‰ï¼šè©•ä¾¡åˆ¶åº¦å°å…¥ï¼ˆå®Œæˆå½¢ï¼‰",
                description: "3è»¸çµ±åˆã«ã‚ˆã‚Šç²¾å¯†ãªäººæãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãŒå®Ÿç¾ã€‚å…±é€š50ç­‰ç´šåˆ¶åº¦Ã—7æ®µéšè©•ä¾¡Ã—4ã‚³ãƒ¼ã‚¹ã®çµ„ã¿åˆã‚ã›ã§å€‹åˆ¥æœ€é©é…ç½®ã‚’å®Ÿç¾ã€‚ã€è·å“¡æ•°ï¼š500åã€‘",
                courseStructure: {
                    A: { ceiling: 50, coefficient: 1.2, label: "å…¨ç¯„å›²ï¼ˆ1-50ç´šï¼‰" },
                    B: { ceiling: 40, coefficient: 1.1, label: "ä¸Šé™40ç´š" },
                    C: { ceiling: 30, coefficient: 1.0, label: "ä¸Šé™30ç´š" },
                    D: { ceiling: 20, coefficient: 0.9, label: "ä¸Šé™20ç´š" }
                },
                data: {
                    top: {
                        A: { 
                            percent: "50%", 
                            count: "50å", 
                            status: "ideal", 
                            intensity: "cell-intensity-5", 
                            priority: "low", 
                            action: "çµŒå–¶å±¤è‚²æˆ",
                            gradeRange: "30-48ç´š",
                            gradeCeiling: "50ç´šåˆ°é”å¯",
                            evaluation: { 'S+': 40, 'S': 35, 'A+': 20, 'A': 5 }
                        },
                        B: { 
                            percent: "40%", 
                            count: "40å", 
                            status: "ideal", 
                            intensity: "cell-intensity-5", 
                            priority: "low", 
                            action: "æ–½è¨­å¹¹éƒ¨åŒ–",
                            gradeRange: "25-38ç´š",
                            gradeCeiling: "ä¸Šé™40ç´š",
                            evaluation: { 'S+': 10, 'S': 30, 'A+': 35, 'A': 25 }
                        },
                        C: { 
                            percent: "10%", 
                            count: "10å", 
                            status: "ideal", 
                            intensity: "cell-intensity-4", 
                            priority: "low", 
                            action: "ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆèªå®š",
                            gradeRange: "20-29ç´š",
                            gradeCeiling: "ä¸Šé™30ç´š",
                            evaluation: { 'S': 15, 'A+': 40, 'A': 45 }
                        },
                        D: { 
                            percent: "0%", 
                            count: "0å", 
                            status: "ideal", 
                            intensity: "cell-intensity-1", 
                            priority: "low", 
                            action: "è©²å½“ãªã—",
                            gradeRange: "-",
                            gradeCeiling: "-",
                            evaluation: {}
                        }
                    },
                    middle: {
                        A: { 
                            percent: "10%", 
                            count: "30å", 
                            status: "ideal", 
                            intensity: "cell-intensity-4", 
                            priority: "low", 
                            action: "é¸æŠœè‚²æˆ",
                            gradeRange: "20-40ç´š",
                            gradeCeiling: "50ç´šåˆ°é”å¯",
                            evaluation: { 'A+': 15, 'A': 45, 'B': 40 }
                        },
                        B: { 
                            percent: "45%", 
                            count: "135å", 
                            status: "ideal", 
                            intensity: "cell-intensity-5", 
                            priority: "low", 
                            action: "å®Ÿå‹™ãƒªãƒ¼ãƒ€ãƒ¼åŒ–",
                            gradeRange: "15-30ç´š",
                            gradeCeiling: "ä¸Šé™40ç´š",
                            evaluation: { 'A': 25, 'B': 65, 'C': 10 }
                        },
                        C: { 
                            percent: "35%", 
                            count: "105å", 
                            status: "ideal", 
                            intensity: "cell-intensity-5", 
                            priority: "low", 
                            action: "å°‚é–€æ€§æ·±åŒ–",
                            gradeRange: "10-22ç´š",
                            gradeCeiling: "ä¸Šé™30ç´š",
                            evaluation: { 'A': 10, 'B': 70, 'C': 20 }
                        },
                        D: { 
                            percent: "10%", 
                            count: "30å", 
                            status: "acceptable", 
                            intensity: "cell-intensity-3", 
                            priority: "low", 
                            action: "æŸ”è»Ÿå‹¤å‹™ç¶™ç¶š",
                            gradeRange: "8-18ç´š",
                            gradeCeiling: "ä¸Šé™20ç´š",
                            evaluation: { 'B': 50, 'C': 40, 'D': 10 }
                        }
                    },
                    low: {
                        A: { 
                            percent: "1%", 
                            count: "1å", 
                            status: "alert", 
                            intensity: "cell-alert-1", 
                            priority: "high", 
                            action: "å€‹åˆ¥å¯¾å¿œ",
                            gradeRange: "15-25ç´š",
                            gradeCeiling: "è¦è»¢æ›æ¤œè¨",
                            evaluation: { 'C': 75, 'D': 25 }
                        },
                        B: { 
                            percent: "34%", 
                            count: "34å", 
                            status: "acceptable", 
                            intensity: "cell-intensity-3", 
                            priority: "medium", 
                            action: "è£œåŠ©å½¹å‰²æ˜ç¢ºåŒ–",
                            gradeRange: "8-20ç´š",
                            gradeCeiling: "ä¸Šé™40ç´š",
                            evaluation: { 'C': 60, 'D': 40 }
                        },
                        C: { 
                            percent: "45%", 
                            count: "45å", 
                            status: "ideal", 
                            intensity: "cell-intensity-5", 
                            priority: "low", 
                            action: "æ¥­å‹™æ¨™æº–åŒ–",
                            gradeRange: "5-15ç´š",
                            gradeCeiling: "ä¸Šé™30ç´š",
                            evaluation: { 'C': 70, 'D': 30 }
                        },
                        D: { 
                            percent: "20%", 
                            count: "20å", 
                            status: "ideal", 
                            intensity: "cell-intensity-5", 
                            priority: "low", 
                            action: "å®šå¹´å¾Œæº–å‚™",
                            gradeRange: "3-12ç´š",
                            gradeCeiling: "ä¸Šé™20ç´š",
                            evaluation: { 'C': 50, 'D': 50 }
                        }
                    }
                },
                hiddenTalents: [
                    { name: "æ–½è¨­å†…DÃ—æ³•äººå†…B", count: 5, type: "ç’°å¢ƒä¸é©åˆ", action: "æ–½è¨­ç•°å‹•æ¤œè¨" },
                    { name: "æ–½è¨­å†…BÃ—æ³•äººå†…S", count: 3, type: "å°‚é–€æ€§çªå‡º", action: "æ³•äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‚ç”»" },
                    { name: "æ–½è¨­å†…SÃ—æ³•äººå†…C", count: 7, type: "ãƒ­ãƒ¼ã‚«ãƒ«ç‰¹åŒ–", action: "æ–½è¨­å†…æ¨©é™å¼·åŒ–" }
                ]
            }
        };
        
        // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚µãƒãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿
        const actionSummaryData = {
            1: {
                top: [
                    "Aã‚³ãƒ¼ã‚¹é¸æŠè€…ã®æ—©æœŸè‚²æˆãƒ—ãƒ­ã‚°ãƒ©ãƒ é–‹å§‹",
                    "æ³•äººæ¨ªæ–­ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®å‚ç”»æ©Ÿä¼šæä¾›",
                    "æ¬¡ä¸–ä»£ãƒªãƒ¼ãƒ€ãƒ¼å€™è£œã¨ã—ã¦ã®æ„è­˜ä»˜ã‘"
                ],
                middle: [
                    "Aã‚³ãƒ¼ã‚¹é¸æŠè€…ã¸ã®ç¾å®Ÿçš„ãªæœŸå¾…å€¤èª¿æ•´",
                    "Bãƒ»Cã‚³ãƒ¼ã‚¹ã®é­…åŠ›ã¨å¯èƒ½æ€§ã®èª¬æ˜å¼·åŒ–",
                    "å€‹åˆ¥ã‚­ãƒ£ãƒªã‚¢ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ã®å®Ÿæ–½"
                ],
                low: [
                    "Aã‚³ãƒ¼ã‚¹é¸æŠè€…ã¸ã®æ—©æœŸã‚³ãƒ¼ã‚¹å¤‰æ›´å‹§å¥¨",
                    "Cãƒ»Dã‚³ãƒ¼ã‚¹ã§ã®å®‰å®šå°±åŠ´æ”¯æ´",
                    "åŸºç¤ã‚¹ã‚­ãƒ«å‘ä¸Šç ”ä¿®ã®å„ªå…ˆå®Ÿæ–½"
                ]
            },
            2: {
                top: [
                    "ç­‰ç´šä¸Šä½è€…ã®å¹¹éƒ¨å€™è£œãƒ—ãƒ­ã‚°ãƒ©ãƒ æœ¬æ ¼åŒ–",
                    "æ–½è¨­é‹å–¶ã¸ã®æ®µéšçš„å‚ç”»",
                    "å¤–éƒ¨ç ”ä¿®ãƒ»MBAæ´¾é£ã®æ¤œè¨"
                ],
                middle: [
                    "ç­‰ç´šã«å¿œã˜ãŸå½¹å‰²ã®æ˜ç¢ºåŒ–",
                    "æ˜‡æ ¼è¦ä»¶ã®å€‹åˆ¥ç›®æ¨™è¨­å®š",
                    "å°‚é–€è³‡æ ¼å–å¾—æ”¯æ´ã®å¼·åŒ–"
                ],
                low: [
                    "é©æ­£ç­‰ç´šã¸ã®é…ç½®èª¿æ•´",
                    "åŸºç¤æ¥­å‹™ã®æ¨™æº–åŒ–æ¨é€²",
                    "ãƒ¡ãƒ³ã‚¿ãƒ¼åˆ¶åº¦ã«ã‚ˆã‚‹å€‹åˆ¥æ”¯æ´"
                ]
            },
            3: {
                top: [
                    "ã‚µã‚¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ç­–å®š",
                    "æˆ¦ç•¥ç«‹æ¡ˆã¸ã®ç›´æ¥å‚ç”»",
                    "æ³•äººå…¨ä½“ã®å¤‰é©ãƒªãƒ¼ãƒ€ãƒ¼è‚²æˆ"
                ],
                middle: [
                    "è©•ä¾¡ã«åŸºã¥ãå€‹åˆ¥è‚²æˆè¨ˆç”»",
                    "éƒ¨é–€æ¨ªæ–­ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒ¼ãƒ‰",
                    "å¾Œé€²æŒ‡å°å½¹ã¨ã—ã¦ã®å½¹å‰²ä»˜ä¸"
                ],
                low: [
                    "å¼·ã¿ã‚’æ´»ã‹ã—ãŸé…ç½®æœ€é©åŒ–",
                    "ãƒãƒ¼ãƒ è£œåŠ©å½¹ã¨ã—ã¦ã®æ˜ç¢ºåŒ–",
                    "ç¶™ç¶šå°±åŠ´ã®ãŸã‚ã®ç’°å¢ƒæ•´å‚™"
                ]
            }
        };
        
        function selectPhase(phase) {
            currentPhase = phase;
            
            // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
            document.querySelectorAll('.phase-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.closest('.phase-btn').classList.add('active');
            
            // ãƒ•ã‚§ãƒ¼ã‚ºæƒ…å ±ã‚’æ›´æ–°
            const phaseInfo = document.getElementById('phaseInfo');
            phaseInfo.innerHTML = `
                <div class="phase-title">${phaseData[phase].title}</div>
                <div class="phase-description">${phaseData[phase].description}</div>
            `;
            
            // ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ã‚’æ›´æ–°
            updateHeatmap(phase);
            
            // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚µãƒãƒªãƒ¼ã‚’æ›´æ–°
            updateActionSummary(phase);
            
            // ç¬¬3æ®µéšã®å ´åˆã€è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã‚’è¡¨ç¤º
            displayEvaluationSystem();
        }
        
        function updateHeatmap(phase) {
            const grid = document.getElementById('heatmapGrid');
            const data = phaseData[phase].data;
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’æ®‹ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿è¡Œã‚’ã‚¯ãƒªã‚¢
            while (grid.children.length > 5) {
                grid.removeChild(grid.lastChild);
            }
            
            // ãƒ‡ãƒ¼ã‚¿è¡Œã‚’è¿½åŠ 
            const layers = [
                { key: 'top', label: 'ä¸Šä½20%', subLabel: 'é«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å±¤' },
                { key: 'middle', label: 'ä¸­é–“60%', subLabel: 'æ¨™æº–ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å±¤' },
                { key: 'low', label: 'è¦æ”¯æ´20%', subLabel: 'è‚²æˆå¿…è¦å±¤' }
            ];
            
            layers.forEach(layer => {
                // è¡Œãƒ˜ãƒƒãƒ€ãƒ¼
                const rowHeader = document.createElement('div');
                rowHeader.className = 'heatmap-row-header';
                rowHeader.innerHTML = `
                    <div>${layer.label}</div>
                    <div class="performance-label">${layer.subLabel}</div>
                `;
                grid.appendChild(rowHeader);
                
                // ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ«
                ['A', 'B', 'C', 'D'].forEach(course => {
                    const cellData = data[layer.key][course];
                    const cell = document.createElement('div');
                    cell.className = `heatmap-cell ${cellData.intensity}`;
                    cell.onclick = () => showDetail(phase, layer.key, course);
                    
                    // ç­‰ç´šç¯„å›²ã®è¡¨ç¤ºï¼ˆç¬¬2æ®µéšä»¥é™ï¼‰
                    let gradeInfo = '';
                    if (phase >= 2 && cellData.gradeRange) {
                        gradeInfo = `
                            <div style="font-size: 0.75em; color: #666; margin: 5px 0; background: rgba(255,255,255,0.7); padding: 3px 5px; border-radius: 3px;">
                                <div>ğŸ“Š ${cellData.gradeRange}</div>
                                ${cellData.gradeCeiling ? `<div style="color: #ff6b6b; font-weight: bold;">ğŸ” ${cellData.gradeCeiling}</div>` : ''}
                            </div>
                        `;
                    } else if (phase === 1 && cellData.gradeRange) {
                        gradeInfo = `
                            <div style="font-size: 0.75em; color: #999; margin: 5px 0; font-style: italic;">
                                ${cellData.gradeRange}
                            </div>
                        `;
                    }
                    
                    // ç¬¬3æ®µéšã§è©•ä¾¡åˆ†å¸ƒã‚’è¡¨ç¤º
                    let evaluationBar = '';
                    if (phase === 3 && cellData.evaluation && Object.keys(cellData.evaluation).length > 0) {
                        evaluationBar = '<div class="evaluation-distribution"><div class="eval-bar">';
                        for (const [grade, percentage] of Object.entries(cellData.evaluation)) {
                            const gradeInfo = evaluationSystem.grades[grade];
                            if (percentage > 0) {
                                evaluationBar += `<span class="eval-segment" style="width: ${percentage}%; background: ${gradeInfo.color}; color: white; font-size: 0.7em; padding: 2px;" title="${grade}: ${percentage}%">${grade}</span>`;
                            }
                        }
                        evaluationBar += '</div></div>';
                    }
                    
                    cell.innerHTML = `
                        <div class="cell-content">
                            <div class="cell-percentage">${cellData.percent}</div>
                            <div class="cell-count">${cellData.count}</div>
                            ${gradeInfo}
                            ${evaluationBar}
                            <div class="cell-status status-${cellData.status}">
                                ${getStatusLabel(cellData.status)}
                            </div>
                            <div class="cell-action">
                                <span class="action-priority priority-${cellData.priority}">
                                    ${getPriorityLabel(cellData.priority)}
                                </span>
                                ${cellData.action}
                            </div>
                        </div>
                    `;
                    grid.appendChild(cell);
                });
            });
            
            // ç¬¬3æ®µéšã®å ´åˆã€åŸ‹ã‚‚ã‚ŒãŸäººææƒ…å ±ã‚’è¡¨ç¤º
            if (phase === 3 && phaseData[phase].hiddenTalents) {
                displayHiddenTalents();
            }
            
            // ç¬¬2æ®µéšä»¥é™ã§ã‚³ãƒ¼ã‚¹æ§‹é€ æƒ…å ±ã‚’è¡¨ç¤º
            if (phase >= 2 && phaseData[phase].courseStructure) {
                displayCourseStructure(phase);
            }
        }
        
        function getStatusLabel(status) {
            const labels = {
                'ideal': 'ç†æƒ³çš„',
                'acceptable': 'è¨±å®¹ç¯„å›²',
                'caution': 'è¦æ³¨æ„',
                'alert': 'è¦å¯¾å¿œ'
            };
            return labels[status] || status;
        }
        
        function getPriorityLabel(priority) {
            const labels = {
                'high': 'é«˜',
                'medium': 'ä¸­',
                'low': 'ä½'
            };
            return labels[priority] || priority;
        }
        
        function updateActionSummary(phase) {
            const summary = document.getElementById('actionSummary');
            const actions = actionSummaryData[phase];
            
            summary.innerHTML = `
                <h3>ğŸ“‹ ç¬¬${phase}æ®µéšã®é‡ç‚¹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h3>
                <div class="action-cards">
                    <div class="action-card">
                        <h4>ğŸ¯ ä¸Šä½20%å±¤</h4>
                        <ul>
                            ${actions.top.map(action => `<li>${action}</li>`).join('')}
                        </ul>
                    </div>
                    <div class="action-card">
                        <h4>ğŸ“Š ä¸­é–“60%å±¤</h4>
                        <ul>
                            ${actions.middle.map(action => `<li>${action}</li>`).join('')}
                        </ul>
                    </div>
                    <div class="action-card">
                        <h4>âš ï¸ è¦æ”¯æ´20%å±¤</h4>
                        <ul>
                            ${actions.low.map(action => `<li>${action}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;
        }
        
        function showDetail(phase, layer, course) {
            const modal = document.getElementById('detailModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            
            const layerLabels = {
                'top': 'ä¸Šä½20%å±¤',
                'middle': 'ä¸­é–“60%å±¤',
                'low': 'è¦æ”¯æ´20%å±¤'
            };
            
            const courseLabels = {
                'A': 'Aã‚³ãƒ¼ã‚¹ï¼ˆãƒ•ãƒ«ã‚¹ãƒšãƒƒã‚¯ï¼‰',
                'B': 'Bã‚³ãƒ¼ã‚¹ï¼ˆæ–½è¨­å†…é™å®šï¼‰',
                'C': 'Cã‚³ãƒ¼ã‚¹ï¼ˆéƒ¨ç½²å›ºå®šï¼‰',
                'D': 'Dã‚³ãƒ¼ã‚¹ï¼ˆé™å®šå‹¤å‹™ï¼‰'
            };
            
            const cellData = phaseData[phase].data[layer][course];
            
            modalTitle.textContent = `${layerLabels[layer]} Ã— ${courseLabels[course]}`;
            
            // è©•ä¾¡åˆ†å¸ƒãƒãƒ£ãƒ¼ãƒˆï¼ˆç¬¬3æ®µéšã®ã¿ï¼‰
            let evaluationChart = '';
            if (phase === 3 && cellData.evaluation && Object.keys(cellData.evaluation).length > 0) {
                evaluationChart = `
                    <h4 style="margin-top: 20px; color: #667eea;">ğŸ“Š è©•ä¾¡åˆ†å¸ƒè©³ç´°</h4>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 10px; margin-bottom: 15px;">
                            ${Object.entries(cellData.evaluation).map(([grade, percentage]) => {
                                const gradeInfo = evaluationSystem.grades[grade];
                                return percentage > 0 ? `
                                    <div style="text-align: center;">
                                        <div style="background: ${gradeInfo.color}; color: white; padding: 8px; border-radius: 6px; font-weight: bold;">
                                            ${grade}
                                        </div>
                                        <div style="margin-top: 5px; font-size: 1.2em; font-weight: bold; color: #2c3e50;">
                                            ${percentage}%
                                        </div>
                                        <div style="font-size: 0.8em; color: #666;">
                                            ${gradeInfo.label}
                                        </div>
                                    </div>
                                ` : '';
                            }).join('')}
                        </div>
                        <div style="background: white; padding: 10px; border-radius: 6px;">
                            <strong>è©•ä¾¡åˆ†æï¼š</strong><br>
                            ${getEvaluationAnalysis(layer, course, cellData.evaluation)}
                        </div>
                    </div>
                `;
            }
            
            modalBody.innerHTML = `
                <div class="metrics-grid">
                    <div class="metric-box">
                        <div class="metric-label">é¸æŠç‡</div>
                        <div class="metric-value">${cellData.percent}</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-label">è©²å½“äººæ•°</div>
                        <div class="metric-value">${cellData.count}</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-label">é©åˆçŠ¶æ…‹</div>
                        <div class="metric-value status-${cellData.status}" style="font-size: 1.2em; padding: 5px 10px; border-radius: 5px;">
                            ${getStatusLabel(cellData.status)}
                        </div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-label">å¯¾å¿œå„ªå…ˆåº¦</div>
                        <div class="metric-value">
                            <span class="action-priority priority-${cellData.priority}" style="font-size: 1.2em; padding: 5px 15px;">
                                ${getPriorityLabel(cellData.priority)}
                            </span>
                        </div>
                    </div>
                </div>
                
                ${evaluationChart}
                
                <h4 style="margin-top: 20px; color: #667eea;">ğŸ“‹ æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h4>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px;">
                    <p style="font-size: 1.1em; line-height: 1.6;">${cellData.action}</p>
                </div>
                
                <h4 style="margin-top: 20px; color: #667eea;">ğŸ¯ å…·ä½“çš„æ–½ç­–</h4>
                <ul style="list-style: none; padding: 0; margin-top: 10px;">
                    ${getDetailedActions(phase, layer, course).map(action => 
                        `<li style="background: #fff; padding: 10px; margin: 5px 0; border-left: 4px solid #667eea; border-radius: 4px;">
                            ${action}
                        </li>`
                    ).join('')}
                </ul>
            `;
            
            modal.classList.add('active');
        }
        
        // è©•ä¾¡åˆ†å¸ƒã®åˆ†æã‚³ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆ
        function getEvaluationAnalysis(layer, course, evaluation) {
            const analyses = {
                'top-A': 'S+ãƒ»Sè©•ä¾¡ãŒ75%ã‚’å ã‚ã€æ¬¡ä¸–ä»£çµŒå–¶å±¤ã¨ã—ã¦æœ€é©ãªäººæç¾¤ã§ã™ã€‚',
                'top-B': 'A+ãƒ»Sè©•ä¾¡ä¸­å¿ƒã§ã€æ–½è¨­é‹å–¶ã®ä¸­æ ¸ã‚’æ‹…ãˆã‚‹å®ŸåŠ›ã‚’æŒã£ã¦ã„ã¾ã™ã€‚',
                'top-C': 'A+ãƒ»Aè©•ä¾¡ãŒä¸»ä½“ã§ã€å°‚é–€é ˜åŸŸã§ã®ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ãŒæœŸå¾…ã§ãã¾ã™ã€‚',
                'middle-A': 'Aãƒ»Bè©•ä¾¡ãŒä¸­å¿ƒã€‚ä¸Šä½å±¤ã¸ã®æˆé•·å¯èƒ½æ€§ã‚’ç§˜ã‚ãŸäººæç¾¤ã§ã™ã€‚',
                'middle-B': 'Bè©•ä¾¡ãŒ65%ã¨å®‰å®šã€‚å®Ÿå‹™ã®ç¢ºå®Ÿãªé‚è¡ŒãŒæœŸå¾…ã§ãã¾ã™ã€‚',
                'middle-C': 'Bè©•ä¾¡ä¸­å¿ƒã§å°‚é–€æ€§ã‚’ç€å®Ÿã«æ·±ã‚ã¦ã„ã‚‹æ®µéšã§ã™ã€‚',
                'middle-D': 'Bãƒ»Cè©•ä¾¡ãŒæ··åœ¨ã€‚å€‹åˆ¥ã®äº‹æƒ…ã«é…æ…®ã—ãŸæ´»ç”¨ãŒå¿…è¦ã§ã™ã€‚',
                'low-A': 'Cãƒ»Dè©•ä¾¡ã®ãŸã‚ã€æ—©æ€¥ãªã‚³ãƒ¼ã‚¹å¤‰æ›´ãŒå¿…è¦ã§ã™ã€‚',
                'low-B': 'Cãƒ»Dè©•ä¾¡ã§ã™ãŒã€é©åˆ‡ãªæ”¯æ´ã§æˆé•·å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚',
                'low-C': 'Cãƒ»Dè©•ä¾¡ãªãŒã‚‰ã€å®šå‹æ¥­å‹™ã§ã¯å®‰å®šçš„ãªè²¢çŒ®ãŒå¯èƒ½ã§ã™ã€‚',
                'low-D': 'Cãƒ»Dè©•ä¾¡ã§ã™ãŒã€é™å®šçš„ãªå½¹å‰²ã§ç¶™ç¶šå°±åŠ´ãŒå¯èƒ½ã§ã™ã€‚'
            };
            
            return analyses[`${layer}-${course}`] || 'è©•ä¾¡åˆ†å¸ƒã‚’åˆ†æä¸­...';
        }
        
        function getDetailedActions(phase, layer, course) {
            // è©³ç´°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã®é‹ç”¨ã§ã¯å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å–å¾—ï¼‰
            const actions = {
                '1-top-A': [
                    'å››åŠæœŸã”ã¨ã®æˆé•·ç›®æ¨™è¨­å®šã¨é”æˆåº¦è©•ä¾¡',
                    'æ³•äººæœ¬éƒ¨ã§ã®ç ”ä¿®å‚åŠ ï¼ˆæœˆ1å›ï¼‰',
                    'ä»–æ–½è¨­è¦‹å­¦ãƒ»äº¤æµãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ã®å‚åŠ ',
                    'ãƒ¡ãƒ³ã‚¿ãƒ¼åˆ¶åº¦ã«ã‚ˆã‚‹å€‹åˆ¥æŒ‡å°'
                ],
                '1-middle-A': [
                    'èƒ½åŠ›è©•ä¾¡é¢è«‡ã®å®Ÿæ–½ï¼ˆ3ãƒ¶æœˆã”ã¨ï¼‰',
                    'ã‚³ãƒ¼ã‚¹é¸æŠã®å†æ¤œè¨æ©Ÿä¼šæä¾›',
                    'åŸºç¤ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆç ”ä¿®ã¸ã®å‚åŠ ',
                    'ç¾å®Ÿçš„ãªã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹æç¤º'
                ],
                '1-low-A': [
                    'å³æ™‚ã®å€‹åˆ¥é¢è«‡å®Ÿæ–½',
                    'Bãƒ»Cã‚³ãƒ¼ã‚¹ã¸ã®å¤‰æ›´å‹§å¥¨',
                    'åŸºç¤ã‚¹ã‚­ãƒ«å‘ä¸Šãƒ—ãƒ­ã‚°ãƒ©ãƒ å„ªå…ˆé©ç”¨',
                    'æ¥­å‹™è² è·ã®é©æ­£åŒ–'
                ],
                // ä»–ã®çµ„ã¿åˆã‚ã›ã‚‚åŒæ§˜ã«å®šç¾©...
            };
            
            const key = `${phase}-${layer}-${course}`;
            return actions[key] || [
                'å€‹åˆ¥è©•ä¾¡ã®å®Ÿæ–½',
                'é©æ€§ã«å¿œã˜ãŸç ”ä¿®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ',
                'å®šæœŸçš„ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯',
                'ã‚­ãƒ£ãƒªã‚¢ç›®æ¨™ã®æ˜ç¢ºåŒ–'
            ];
        }
        
        function closeModal() {
            document.getElementById('detailModal').classList.remove('active');
        }
        
        // åŸ‹ã‚‚ã‚ŒãŸäººæã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function displayHiddenTalents() {
            const existingContainer = document.querySelector('.hidden-talents-container');
            if (existingContainer) {
                existingContainer.remove();
            }
            
            const container = document.createElement('div');
            container.className = 'hidden-talents-container';
            container.innerHTML = `
                <div class="hidden-talents-title">
                    ğŸ’ 2è»¸è©•ä¾¡ã§ç™ºè¦‹ã•ã‚ŒãŸåŸ‹ã‚‚ã‚ŒãŸäººæï¼ˆ500åä¸­ï¼‰
                </div>
                <div class="hidden-talents-grid">
                    ${phaseData[3].hiddenTalents.map(talent => `
                        <div class="hidden-talent-card">
                            <div class="hidden-talent-type">${talent.type}</div>
                            <div class="hidden-talent-name">${talent.name}</div>
                            <div class="hidden-talent-count">è©²å½“è€…ï¼š${talent.count}å</div>
                            <div class="hidden-talent-action">ğŸ“Œ ${talent.action}</div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            const heatmapContainer = document.querySelector('.heatmap-container');
            heatmapContainer.appendChild(container);
        }
        
        // ã‚³ãƒ¼ã‚¹æ§‹é€ æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function displayCourseStructure(phase) {
            const existingInfo = document.querySelector('.course-structure-info');
            if (existingInfo) {
                existingInfo.remove();
            }
            
            if (!phaseData[phase].courseStructure) return;
            
            const info = document.createElement('div');
            info.className = 'course-structure-info';
            info.style.cssText = 'background: linear-gradient(135deg, #e3f2fd, #bbdefb); padding: 20px; border-radius: 15px; margin: 30px 0; border: 2px solid #2196f3;';
            info.innerHTML = `
                <div style="color: #1565c0; font-size: 1.3em; font-weight: bold; margin-bottom: 15px;">
                    ğŸ¢ å·ç•‘å±€é•·æ¡ˆï¼šå…±é€š50ç­‰ç´šåˆ¶åº¦ã®æ§‹é€ 
                </div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                    ${Object.entries(phaseData[phase].courseStructure).map(([course, data]) => `
                        <div style="background: white; padding: 15px; border-radius: 10px; text-align: center; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                            <div style="font-size: 1.5em; font-weight: bold; color: #1565c0; margin-bottom: 5px;">${course}ã‚³ãƒ¼ã‚¹</div>
                            <div style="color: #666; font-size: 0.9em; margin-bottom: 10px;">${data.label}</div>
                            <div style="background: #e3f2fd; padding: 8px; border-radius: 5px; margin-bottom: 8px;">
                                <div style="font-size: 0.85em; color: #555;">ç­‰ç´šä¸Šé™</div>
                                <div style="font-size: 1.3em; font-weight: bold; color: #1565c0;">${data.ceiling}ç´š</div>
                            </div>
                            <div style="background: #fff3e0; padding: 8px; border-radius: 5px;">
                                <div style="font-size: 0.85em; color: #555;">çµ¦ä¸ä¿‚æ•°</div>
                                <div style="font-size: 1.2em; font-weight: bold; color: #f57c00;">Ã—${data.coefficient}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                <div style="margin-top: 15px; padding: 10px; background: white; border-radius: 8px;">
                    <strong style="color: #1565c0;">åŸºæœ¬çµ¦è¨ˆç®—å¼ï¼š</strong>
                    <span style="color: #666;">ç­‰ç´šãƒ†ãƒ¼ãƒ–ãƒ«é‡‘é¡ Ã— ã‚³ãƒ¼ã‚¹ä¿‚æ•° = å®Ÿæ”¯çµ¦é¡</span>
                    <div style="font-size: 0.9em; color: #888; margin-top: 5px;">
                        ä¾‹ï¼š25ç­‰ç´šã®å ´åˆ â†’ A:Ã—1.2ã€B:Ã—1.1ã€C:Ã—1.0ã€D:Ã—0.9
                    </div>
                </div>
            `;
            
            const legendContainer = document.querySelector('.legend-container');
            legendContainer.parentNode.insertBefore(info, legendContainer);
        }
        
        // ç¬¬3æ®µéšé¸æŠæ™‚ã«è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ã®èª¬æ˜ã‚’è¡¨ç¤º
        function displayEvaluationSystem() {
            const existingInfo = document.querySelector('.evaluation-system-info');
            if (existingInfo) {
                existingInfo.remove();
            }
            
            if (currentPhase !== 3) return;
            
            const info = document.createElement('div');
            info.className = 'evaluation-system-info';
            info.innerHTML = `
                <div class="evaluation-system-title">
                    ğŸ“Š 100ç‚¹æº€ç‚¹è©•ä¾¡åˆ¶åº¦ã«ã‚ˆã‚‹ç²¾å¯†ãªäººææŠŠæ¡
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h5 style="color: #2e7d32; margin-bottom: 10px;">æŠ€è¡“è©•ä¾¡ï¼ˆ50ç‚¹ï¼‰+ çµ„ç¹”è²¢çŒ®è©•ä¾¡ï¼ˆ50ç‚¹ï¼‰</h5>
                        <div style="background: white; padding: 10px; border-radius: 8px;">
                            <div style="margin-bottom: 8px;">ğŸ”§ <strong>æŠ€è¡“è©•ä¾¡</strong></div>
                            <div style="font-size: 0.9em; color: #666; margin-left: 20px;">
                                â€¢ æ³•äººçµ±ä¸€é …ç›®ï¼ˆ30ç‚¹ï¼‰<br>
                                â€¢ æ–½è¨­ç‰¹åŒ–é …ç›®ï¼ˆ20ç‚¹ï¼‰
                            </div>
                            <div style="margin-top: 10px; margin-bottom: 8px;">ğŸ¤ <strong>çµ„ç¹”è²¢çŒ®è©•ä¾¡</strong></div>
                            <div style="font-size: 0.9em; color: #666; margin-left: 20px;">
                                â€¢ æ–½è¨­è²¢çŒ®ï¼ˆ25ç‚¹ï¼‰<br>
                                â€¢ æ³•äººè²¢çŒ®ï¼ˆ25ç‚¹ï¼‰
                            </div>
                        </div>
                    </div>
                    <div>
                        <h5 style="color: #2e7d32; margin-bottom: 10px;">7æ®µéšæœ€çµ‚è©•ä¾¡</h5>
                        <div class="evaluation-grades-grid">
                            ${Object.entries(evaluationSystem.grades).map(([grade, info]) => `
                                <div class="evaluation-grade-box" style="background: ${info.color};">
                                    <div>${grade}</div>
                                    <div style="font-size: 0.7em;">${info.percentage}%</div>
                                </div>
                            `).join('')}
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: white; border-radius: 8px;">
                            <div style="font-size: 0.9em; color: #666;">
                                <strong>2è»¸ãƒãƒˆãƒªãƒƒã‚¯ã‚¹è©•ä¾¡ï¼š</strong><br>
                                æ–½è¨­å†…ç›¸å¯¾è©•ä¾¡ Ã— æ³•äººå†…ç›¸å¯¾è©•ä¾¡ã§æ±ºå®š
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            const legendContainer = document.querySelector('.legend-container');
            legendContainer.parentNode.insertBefore(info, legendContainer);
        }
        
        // åˆæœŸè¡¨ç¤º
        updateHeatmap(1);
    </script>
</body>
</html>